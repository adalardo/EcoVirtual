meta.er(100,20,20,0.25,0.1,0.05)
library("EcoVirtual")
library("RcmdrPlugin.EcoVirtual")
detach("package:Rcmdr")
library("RcmdrPlugin.EcoVirtual")
meta.comp<-function(tmax,ln,cl,fi1,fi2,i1,i2,pe,D=0, anima=TRUE)
{
pais<-array(0, dim=c(ln,cl,tmax))
#if(D=0)
#{
F1 <- 1-(pe/i1)
F2 <- pe/i1-i1/i2
if(F1<=0)
{
F1=0
F2 <- 1-(pe/i2)
}
#}
#if(D>0)
#{
#F1<-1-D-pe/i1
#F2<-pe/i1 - pe/i2- i1/i2*(1-D-pe/i1)
#}
Nt <- ln*cl
N <- floor(Nt*(1-D))
resultado=matrix(nrow=tmax,ncol=3)
n1 <- floor(fi1*N)
n2 <- floor(fi2*N)
n0 <- N-(n1+n2)
antes <- sample(rep(c(2,1,0),c(n2,n1,n0)))
nD=rep(-0.5,Nt-N)
pais[,,1]<-c(antes,nD)
resultado[,1] <- 1:tmax
resultado[1,2:3] <- c(sum(antes==1),sum(antes==2))/N
for(tc in 2:tmax)
{
depois <- rep(0,N)
pi1=i1*sum(antes==1)/Nt
pi2=i2*sum(antes==2)/Nt
if(pi1>1)
{
pi1= 1
}
if(pi2>1)
{
pi2= 1
}
depois[antes==1]<-sample(c(0,1),sum(antes==1),replace=TRUE,prob=c(pe,1-pe))
depois[antes==2]<-sample(c(0,2),sum(antes==2),replace=TRUE,prob=c(pe,1-pe))
depois[antes==0] <- sample(c(0,2),sum(antes==0),replace=TRUE,prob=c(1-pi2,pi2))
d1<-sample(c(0,1),sum(antes!=1),replace=TRUE,prob=c(1-pi1,pi1))
depois[antes!=1][d1==1] <- 1
resultado[tc,2:3]=c(sum(depois==1),sum(depois==2))/Nt
pais[,,tc]<-c(depois,nD)
antes <- depois
}
x11()
if(anima==TRUE)
{
metacomp.anima(pais)
}
x11()
plot(1:tmax,resultado[,2],type="l",xlab="Time",ylab="Path occupance", ylim=c(0,max(resultado[,c(2,3)]*1.1)),main="Competition and Internal Colonization", sub=paste("cl=",cl,"; ln=",ln,";  fi1=",fi1,";  fi2=", fi2,";  i1=",i1,";  i2=",i2,";  pe=",pe,";  D=",D, sep=""),cex.sub=0.7,lwd=2, col="red")
lines(1:tmax,resultado[,3],col="blue", lwd=2)
abline(h=F1,col="red",lwd=1.5,lty=2)
abline(h=F2,col="blue",lwd=1.5,lty=2)
if(D>0)abline(h=1-D,lty=2)
legend("topright",legend= c("Best competitor", "Inferior competitor"),col=c("red","blue"),lty=2, bty="n", title="Equilibrium without Habitat destruction")
invisible(pais)
}
{
pais<-array(0, dim=c(ln,cl,tmax))
#if(D=0)
#{
F1 <- 1-(pe/i1)
F2 <- pe/i1-i1/i2
if(F1<=0)
{
F1=0
F2 <- 1-(pe/i2)
}
#}
#if(D>0)
#{
#F1<-1-D-pe/i1
#F2<-pe/i1 - pe/i2- i1/i2*(1-D-pe/i1)
#}
Nt <- ln*cl
N <- floor(Nt*(1-D))
resultado=matrix(nrow=tmax,ncol=3)
n1 <- floor(fi1*N)
n2 <- floor(fi2*N)
n0 <- N-(n1+n2)
antes <- sample(rep(c(2,1,0),c(n2,n1,n0)))
nD=rep(-0.5,Nt-N)
pais[,,1]<-c(antes,nD)
resultado[,1] <- 1:tmax
resultado[1,2:3] <- c(sum(antes==1),sum(antes==2))/N
for(tc in 2:tmax)
{
depois <- rep(0,N)
pi1=i1*sum(antes==1)/Nt
pi2=i2*sum(antes==2)/Nt
if(pi1>1)
{
pi1= 1
}
if(pi2>1)
{
pi2= 1
}
depois[antes==1]<-sample(c(0,1),sum(antes==1),replace=TRUE,prob=c(pe,1-pe))
depois[antes==2]<-sample(c(0,2),sum(antes==2),replace=TRUE,prob=c(pe,1-pe))
depois[antes==0] <- sample(c(0,2),sum(antes==0),replace=TRUE,prob=c(1-pi2,pi2))
d1<-sample(c(0,1),sum(antes!=1),replace=TRUE,prob=c(1-pi1,pi1))
depois[antes!=1][d1==1] <- 1
resultado[tc,2:3]=c(sum(depois==1),sum(depois==2))/Nt
pais[,,tc]<-c(depois,nD)
antes <- depois
}
x11()
if(anima==TRUE)
{
metacomp.anima(pais)
}
x11()
plot(1:tmax,resultado[,2],type="l",xlab="Time",ylab="Path occupance", ylim=c(0,max(resultado[,c(2,3)]*1.1)),main="Competition and Internal Colonization", sub=paste("cl=",cl,"; ln=",ln,";  fi1=",fi1,";  fi2=", fi2,";  i1=",i1,";  i2=",i2,";  pe=",pe,";  D=",D, sep=""),cex.sub=0.7,lwd=2, col="red")
lines(1:tmax,resultado[,3],col="blue", lwd=2)
abline(h=F1,col="red",lwd=1.5,lty=2)
abline(h=F2,col="blue",lwd=1.5,lty=2)
if(D>0)abline(h=1-D,lty=2)
legend("topright",legend= c("Best competitor", "Inferior competitor"),col=c("red","blue"),lty=2, bty="n", title="Equilibrium without Habitat destruction")
invisible(pais)
}
{
pais<-array(0, dim=c(ln,cl,tmax))
#if(D=0)
#{
F1 <- 1-(pe/i1)
F2 <- pe/i1-i1/i2
if(F1<=0)
{
F1=0
F2 <- 1-(pe/i2)
}
#}
#if(D>0)
#{
#F1<-1-D-pe/i1
#F2<-pe/i1 - pe/i2- i1/i2*(1-D-pe/i1)
#}
Nt <- ln*cl
N <- floor(Nt*(1-D))
resultado=matrix(nrow=tmax,ncol=3)
n1 <- floor(fi1*N)
n2 <- floor(fi2*N)
n0 <- N-(n1+n2)
antes <- sample(rep(c(2,1,0),c(n2,n1,n0)))
nD=rep(-0.5,Nt-N)
pais[,,1]<-c(antes,nD)
resultado[,1] <- 1:tmax
resultado[1,2:3] <- c(sum(antes==1),sum(antes==2))/N
for(tc in 2:tmax)
{
depois <- rep(0,N)
pi1=i1*sum(antes==1)/Nt
pi2=i2*sum(antes==2)/Nt
if(pi1>1)
{
pi1= 1
}
if(pi2>1)
{
pi2= 1
}
depois[antes==1]<-sample(c(0,1),sum(antes==1),replace=TRUE,prob=c(pe,1-pe))
depois[antes==2]<-sample(c(0,2),sum(antes==2),replace=TRUE,prob=c(pe,1-pe))
depois[antes==0] <- sample(c(0,2),sum(antes==0),replace=TRUE,prob=c(1-pi2,pi2))
d1<-sample(c(0,1),sum(antes!=1),replace=TRUE,prob=c(1-pi1,pi1))
depois[antes!=1][d1==1] <- 1
resultado[tc,2:3]=c(sum(depois==1),sum(depois==2))/Nt
pais[,,tc]<-c(depois,nD)
antes <- depois
}
x11()
if(anima==TRUE)
{
metacomp.anima(pais)
}
x11()
plot(1:tmax,resultado[,2],type="l",xlab="Time",ylab="Path occupance", ylim=c(0,max(resultado[,c(2,3)]*1.1)),main="Competition and Internal Colonization", sub=paste("cl=",cl,"; ln=",ln,";  fi1=",fi1,";  fi2=", fi2,";  i1=",i1,";  i2=",i2,";  pe=",pe,";  D=",D, sep=""),cex.sub=0.7,lwd=2, col="red")
lines(1:tmax,resultado[,3],col="blue", lwd=2)
abline(h=F1,col="red",lwd=1.5,lty=2)
abline(h=F2,col="blue",lwd=1.5,lty=2)
if(D>0)abline(h=1-D,lty=2)
legend("topright",legend= c("Best competitor", "Inferior competitor"),col=c("red","blue"),lty=2, bty="n", title="Equilibrium without Habitat destruction")
invisible(pais)
}
{
pais<-array(0, dim=c(ln,cl,tmax))
#if(D=0)
#{
F1 <- 1-(pe/i1)
F2 <- pe/i1-i1/i2
if(F1<=0)
{
F1=0
F2 <- 1-(pe/i2)
}
#}
#if(D>0)
#{
#F1<-1-D-pe/i1
#F2<-pe/i1 - pe/i2- i1/i2*(1-D-pe/i1)
#}
Nt <- ln*cl
N <- floor(Nt*(1-D))
resultado=matrix(nrow=tmax,ncol=3)
n1 <- floor(fi1*N)
n2 <- floor(fi2*N)
n0 <- N-(n1+n2)
antes <- sample(rep(c(2,1,0),c(n2,n1,n0)))
nD=rep(-0.5,Nt-N)
pais[,,1]<-c(antes,nD)
resultado[,1] <- 1:tmax
resultado[1,2:3] <- c(sum(antes==1),sum(antes==2))/N
for(tc in 2:tmax)
{
depois <- rep(0,N)
pi1=i1*sum(antes==1)/Nt
pi2=i2*sum(antes==2)/Nt
if(pi1>1)
{
pi1= 1
}
if(pi2>1)
{
pi2= 1
}
depois[antes==1]<-sample(c(0,1),sum(antes==1),replace=TRUE,prob=c(pe,1-pe))
depois[antes==2]<-sample(c(0,2),sum(antes==2),replace=TRUE,prob=c(pe,1-pe))
depois[antes==0] <- sample(c(0,2),sum(antes==0),replace=TRUE,prob=c(1-pi2,pi2))
d1<-sample(c(0,1),sum(antes!=1),replace=TRUE,prob=c(1-pi1,pi1))
depois[antes!=1][d1==1] <- 1
resultado[tc,2:3]=c(sum(depois==1),sum(depois==2))/Nt
pais[,,tc]<-c(depois,nD)
antes <- depois
}
x11()
if(anima==TRUE)
{
metacomp.anima(pais)
}
x11()
plot(1:tmax,resultado[,2],type="l",xlab="Time",ylab="Path occupance", ylim=c(0,max(resultado[,c(2,3)]*1.1)),main="Competition and Internal Colonization", sub=paste("cl=",cl,"; ln=",ln,";  fi1=",fi1,";  fi2=", fi2,";  i1=",i1,";  i2=",i2,";  pe=",pe,";  D=",D, sep=""),cex.sub=0.7,lwd=2, col="red")
lines(1:tmax,resultado[,3],col="blue", lwd=2)
abline(h=F1,col="red",lwd=1.5,lty=2)
abline(h=F2,col="blue",lwd=1.5,lty=2)
if(D>0)abline(h=1-D,lty=2)
legend("topright",legend= c("Best competitor", "Inferior competitor"),col=c("red","blue"),lty=2, bty="n", title="Equilibrium without Habitat destruction")
invisible(pais)
}
pais<-array(0, dim=c(ln,cl,tmax))
#if(D=0)
#{
F1 <- 1-(pe/i1)
F2 <- pe/i1-i1/i2
if(F1<=0)
{
F1=0
F2 <- 1-(pe/i2)
}
#}
#if(D>0)
#{
#F1<-1-D-pe/i1
#F2<-pe/i1 - pe/i2- i1/i2*(1-D-pe/i1)
#}
Nt <- ln*cl
N <- floor(Nt*(1-D))
resultado=matrix(nrow=tmax,ncol=3)
n1 <- floor(fi1*N)
n2 <- floor(fi2*N)
n0 <- N-(n1+n2)
antes <- sample(rep(c(2,1,0),c(n2,n1,n0)))
nD=rep(-0.5,Nt-N)
pais[,,1]<-c(antes,nD)
resultado[,1] <- 1:tmax
resultado[1,2:3] <- c(sum(antes==1),sum(antes==2))/N
for(tc in 2:tmax)
{
depois <- rep(0,N)
pi1=i1*sum(antes==1)/Nt
pi2=i2*sum(antes==2)/Nt
if(pi1>1)
{
pi1= 1
}
if(pi2>1)
{
pi2= 1
}
depois[antes==1]<-sample(c(0,1),sum(antes==1),replace=TRUE,prob=c(pe,1-pe))
depois[antes==2]<-sample(c(0,2),sum(antes==2),replace=TRUE,prob=c(pe,1-pe))
depois[antes==0] <- sample(c(0,2),sum(antes==0),replace=TRUE,prob=c(1-pi2,pi2))
d1<-sample(c(0,1),sum(antes!=1),replace=TRUE,prob=c(1-pi1,pi1))
depois[antes!=1][d1==1] <- 1
resultado[tc,2:3]=c(sum(depois==1),sum(depois==2))/Nt
pais[,,tc]<-c(depois,nD)
antes <- depois
}
x11()
if(anima==TRUE)
{
metacomp.anima(pais)
}
x11()
plot(1:tmax,resultado[,2],type="l",xlab="Time",ylab="Path occupance", ylim=c(0,max(resultado[,c(2,3)]*1.1)),main="Competition and Internal Colonization", sub=paste("cl=",cl,"; ln=",ln,";  fi1=",fi1,";  fi2=", fi2,";  i1=",i1,";  i2=",i2,";  pe=",pe,";  D=",D, sep=""),cex.sub=0.7,lwd=2, col="red")
lines(1:tmax,resultado[,3],col="blue", lwd=2)
abline(h=F1,col="red",lwd=1.5,lty=2)
abline(h=F2,col="blue",lwd=1.5,lty=2)
if(D>0)abline(h=1-D,lty=2)
legend("topright",legend= c("Best competitor", "Inferior competitor"),col=c("red","blue"),lty=2, bty="n", title="Equilibrium without Habitat destruction")
invisible(pais)
}
}
}
}
}emd
etre
stres
}fsdfw{}
dev.off()
library("RcmdrPlugin.EcoVirtual")
help(gr.toff)
gr.toff=function(rq, fsp1,pe,add=FALSE,...)
{
#	rq <- as.numeric(tclvalue(rqVar))
#	fsp1 <- as.numeric(tclvalue(fsp1Var))
#	pe <- as.numeric(tclvalue(peVar))
rank=1:rq
ci= pe/(1-fsp1)^(2*rank-1)
px= fsp1*(1-fsp1)^(rank-1)
if(add==FALSE)
{
toff<-x11( width=5, height=5)
}
old<-par(mar=c(3,3,3,3))
plot(ci~rank,col="red",ylim=c(0,max(ci)*1.1), type="b", ann=FALSE, axes=FALSE)
axis(4, cex.axis=0.8, col='red')#, yaxp=c(0,3,3))
par(new=TRUE)
plot(px~rank, ylim=c(0,fsp1),type="b", bty="n",  ann=FALSE, cex.axis=0.8)#yaxt="n", xaxp=c(0,10,5))
#axis(2, cex.axis=0.8)#, yaxp=c(0,0.2,4))
mtext("Specie competitive rank", 1, 2, cex=0.9)
mtext("Abundance", 2, 2, cex=0.9)
mtext("Colonization rate", 4, 2, cex=0.9)
mtext("Trade-off Species Rank ", 3, 0, cex=1.2)
par(old)
}
gr.toff(rq =  10 , fsp1 =  0.2 , pe =  0.1 ,add=FALSE)
gr.toff=function(rq, fsp1,pe,add=FALSE,...)
{
#	rq <- as.numeric(tclvalue(rqVar))
#	fsp1 <- as.numeric(tclvalue(fsp1Var))
#	pe <- as.numeric(tclvalue(peVar))
rank=1:rq
ci= pe/(1-fsp1)^(2*rank-1)
px= fsp1*(1-fsp1)^(rank-1)
if(add==FALSE)
{
toff<-x11( width=5, height=5)
}
old<-par(mar=c(3,3,3,3))
plot(ci~rank,col="red",ylim=c(0,max(ci)*1.1), type="b", ann=FALSE, axes=FALSE)
axis(4, cex.axis=0.8, col='red')#, yaxp=c(0,3,3))
par(new=TRUE)
plot(px~rank, ylim=c(0,fsp1),type="b", bty="n",  ann=FALSE, cex.axis=0.8)#yaxt="n", xaxp=c(0,10,5))
#axis(2, cex.axis=0.8)#, yaxp=c(0,0.2,4))
mtext("Specie competitive rank", 1, 2, cex=0.9)
mtext("Abundance", 2, 2, cex=0.9)
mtext("Colonization rate", 4, 2, cex=0.9, col='red')
mtext("Trade-off Species Rank ", 3, 0, cex=1.2)
par(old)
}
gr.toff(rq =  10 , fsp1 =  0.2 , pe =  0.1 ,add=FALSE)
gr.toff=function(rq, fsp1,pe,add=FALSE,...)
{
#	rq <- as.numeric(tclvalue(rqVar))
#	fsp1 <- as.numeric(tclvalue(fsp1Var))
#	pe <- as.numeric(tclvalue(peVar))
rank=1:rq
ci= pe/(1-fsp1)^(2*rank-1)
px= fsp1*(1-fsp1)^(rank-1)
if(add==FALSE)
{
toff<-x11( width=5, height=5)
}
old<-par(mar=c(3,3,3,3))
plot(ci~rank, col="red",ylim=c(0,max(ci)*1.1), type="b", ann=FALSE, axes=FALSE, yaxt=F)
axis(4, cex.axis=0.8, col='red')#, yaxp=c(0,3,3))
par(new=TRUE)
plot(px~rank, ylim=c(0,fsp1),type="b", bty="n",  ann=FALSE, cex.axis=0.8)#yaxt="n", xaxp=c(0,10,5))
#axis(2, cex.axis=0.8)#, yaxp=c(0,0.2,4))
mtext("Specie competitive rank", 1, 2, cex=0.9)
mtext("Abundance", 2, 2, cex=0.9)
mtext("Colonization rate", 4, 2, cex=0.9, col='red')
mtext("Trade-off Species Rank ", 3, 0, cex=1.2)
par(old)
}
gr.toff(rq =  10 , fsp1 =  0.2 , pe =  0.1 ,add=FALSE)
gr.toff(rq =  10 , fsp1 =  0.2 , pe =  0.1 ,add=FALSE)
gr.toff=function(rq, fsp1,pe,add=FALSE,...)
{
#	rq <- as.numeric(tclvalue(rqVar))
#	fsp1 <- as.numeric(tclvalue(fsp1Var))
#	pe <- as.numeric(tclvalue(peVar))
rank=1:rq
ci= pe/(1-fsp1)^(2*rank-1)
px= fsp1*(1-fsp1)^(rank-1)
if(add==FALSE)
{
toff<-x11( width=5, height=5)
}
old<-par(mar=c(3,3,3,3))
plot(ci~rank, col="red",ylim=c(0,max(ci)*1.1), type="b", ann=FALSE, axes=FALSE, yaxt='n')
axis(4, cex.axis=0.8, col='red')#, yaxp=c(0,3,3))
par(new=TRUE)
plot(px~rank, ylim=c(0,fsp1),type="b", bty="n",  ann=FALSE, cex.axis=0.8)#yaxt="n", xaxp=c(0,10,5))
#axis(2, cex.axis=0.8)#, yaxp=c(0,0.2,4))
mtext("Specie competitive rank", 1, 2, cex=0.9)
mtext("Abundance", 2, 2, cex=0.9)
mtext("Colonization rate", 4, 2, cex=0.9, col='red')
mtext("Trade-off Species Rank ", 3, 0, cex=1.2)
par(old)
}
gr.toff(rq =  10 , fsp1 =  0.2 , pe =  0.1 ,add=FALSE)
###
gr.toff=function(rq, fsp1,pe,add=FALSE,...)
{
#	rq <- as.numeric(tclvalue(rqVar))
#	fsp1 <- as.numeric(tclvalue(fsp1Var))
#	pe <- as.numeric(tclvalue(peVar))
rank=1:rq
ci= pe/(1-fsp1)^(2*rank-1)
px= fsp1*(1-fsp1)^(rank-1)
if(add==FALSE)
{
toff<-x11( width=5, height=5)
}
old<-par(mar=c(3,3,3,3))
plot(ci~rank, col="red",ylim=c(0,max(ci)*1.1), type="b", ann=FALSE, axes=FALSE,)
axis(4, cex.axis=0.8, col.axis='red')#, yaxp=c(0,3,3))
par(new=TRUE)
plot(px~rank, ylim=c(0,fsp1),type="b", bty="n",  ann=FALSE, cex.axis=0.8)#yaxt="n", xaxp=c(0,10,5))
#axis(2, cex.axis=0.8)#, yaxp=c(0,0.2,4))
mtext("Specie competitive rank", 1, 2, cex=0.9)
mtext("Abundance", 2, 2, cex=0.9)
mtext("Colonization rate", 4, 2, cex=0.9, col='red')
mtext("Trade-off Species Rank ", 3, 0, cex=1.2)
par(old)
}
gr.toff(rq =  10 , fsp1 =  0.2 , pe =  0.1 ,add=FALSE)
gr.toff=function(rq, fsp1,pe,add=FALSE,...)
{
#	rq <- as.numeric(tclvalue(rqVar))
#	fsp1 <- as.numeric(tclvalue(fsp1Var))
#	pe <- as.numeric(tclvalue(peVar))
rank=1:rq
ci= pe/(1-fsp1)^(2*rank-1)
px= fsp1*(1-fsp1)^(rank-1)
if(add==FALSE)
{
toff<-x11( width=5, height=5)
}
old<-par(mar=c(3,3,3,3))
plot(ci~rank, col="red",ylim=c(0,max(ci)*1.1), type="b", ann=FALSE, axes=FALSE,)
axis(4, cex.axis=0.8, col.axis='red', col='red')#, yaxp=c(0,3,3))
par(new=TRUE)
plot(px~rank, ylim=c(0,fsp1),type="b", bty="n",  ann=FALSE, cex.axis=0.8)#yaxt="n", xaxp=c(0,10,5))
#axis(2, cex.axis=0.8)#, yaxp=c(0,0.2,4))
mtext("Specie competitive rank", 1, 2, cex=0.9)
mtext("Abundance", 2, 2, cex=0.9)
mtext("Colonization rate", 4, 2, cex=0.9, col='red')
mtext("Trade-off Species Rank ", 3, 0, cex=1.2)
par(old)
}
gr.toff(rq =  10 , fsp1 =  0.2 , pe =  0.1 ,add=FALSE)
gr.toff=function(rq, fsp1,pe,add=FALSE,...)
{
#	rq <- as.numeric(tclvalue(rqVar))
#	fsp1 <- as.numeric(tclvalue(fsp1Var))
#	pe <- as.numeric(tclvalue(peVar))
rank=1:rq
ci= pe/(1-fsp1)^(2*rank-1)
px= fsp1*(1-fsp1)^(rank-1)
if(add==FALSE)
{
toff<-x11( width=5, height=5)
}
old<-par(mar=c(3,3,3,3))
plot(ci~rank, col="red",ylim=c(0,max(ci)*1.2), type="b", ann=FALSE, axes=FALSE,)
axis(4, cex.axis=0.8, col.axis='red', col='red')#, yaxp=c(0,3,3))
par(new=TRUE)
plot(px~rank, ylim=c(0,fsp1),type="b", bty="n",  ann=FALSE, cex.axis=0.8)#yaxt="n", xaxp=c(0,10,5))
#axis(2, cex.axis=0.8)#, yaxp=c(0,0.2,4))
mtext("Specie competitive rank", 1, 2, cex=0.9)
mtext("Abundance", 2, 2, cex=0.9)
mtext("Colonization rate", 4, 2, cex=0.9, col='red')
mtext("Trade-off Species Rank ", 3, 0, cex=1.2)
par(old)
}
gr.toff(rq =  10 , fsp1 =  0.2 , pe =  0.1 ,add=FALSE)
